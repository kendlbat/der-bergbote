---
import { ClientRouter } from "astro:transitions";
import "@/styles/globals.css";
import RequireAuth from "@/components/astro/auth/RequireAuth.astro";
import { SignIn, SignOut } from "@/components/react/auth/auth-buttons";

// @ts-ignore
import { pwaAssetsHead } from "virtual:pwa-assets/head";
// @ts-ignore
import { pwaInfo } from "virtual:pwa-info";
import ReloadPrompt from "@/components/pwa/ReloadPrompt.astro";

interface Props {
    title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang="en" class="nord dark">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <meta name="description" content={title} />
        <ClientRouter />
        {pwaInfo && <Fragment set:html={pwaInfo.webManifest.linkTag} />}
        {
            pwaAssetsHead.themeColor && (
                <meta
                    name="theme-color"
                    content={pwaAssetsHead.themeColor.content}
                />
            )
        }
        {pwaAssetsHead.links.map((link: any) => <link {...link} />)}
        <link rel="icon" href="/icons/favicon.svg" />
        <title>{title}</title>
    </head>

    <body>
        <RequireAuth>
            <SignOut client:load />
        </RequireAuth>
        <slot />
        <ReloadPrompt />
    </body>
</html>
